import{c as V,j as e}from"./createLucideIcon.CVHfnsbb.js";import{r as n}from"./index.R_mOzHLH.js";import{X as H}from"./x.Cj5SZKKx.js";import{P as U,S as se}from"./square-pen.CC4qF3EE.js";import{q as ae,o as te,w as B,c as le,d as P,g as re,a as q,u as ne,b as ie}from"./firebase.C_cAEJpe.js";import{S as oe}from"./save.8cr_MGI7.js";import{S as F}from"./shield.CeuqkkJc.js";import{G as z,B as de}from"./graduation-cap.DDdj_iDS.js";import{M}from"./mail.CxD8Gvmi.js";import{U as ce}from"./users.DMWJKV87.js";import{B as me}from"./book-open.Co02gDol.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=V("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=V("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),G=["bg-blue-100 text-blue-800 border-blue-200","bg-green-100 text-green-800 border-green-200","bg-purple-100 text-purple-800 border-purple-200","bg-pink-100 text-pink-800 border-pink-200","bg-yellow-100 text-yellow-800 border-yellow-200","bg-indigo-100 text-indigo-800 border-indigo-200","bg-red-100 text-red-800 border-red-200","bg-orange-100 text-orange-800 border-orange-200","bg-teal-100 text-teal-800 border-teal-200","bg-cyan-100 text-cyan-800 border-cyan-200"],K=({label:s,availableTags:m,selectedTags:l,onTagsChange:r,placeholder:D="Select tags...",maxTags:x,allowCustomTags:b=!1})=>{const[v,c]=n.useState(!1),[o,C]=n.useState(""),[u,f]=n.useState(!1),[N,h]=n.useState(""),S=m.filter(t=>!l.some(j=>j.id===t.id)&&t.label.toLowerCase().includes(o.toLowerCase())),I=t=>{x&&l.length>=x||(r([...l,t]),C(""))},L=t=>{r(l.filter(j=>j.id!==t))},p=()=>{if(!N.trim())return;const t={id:`custom-${Date.now()}`,label:N.trim(),color:G[l.length%G.length]};I(t),h(""),f(!1)},A=t=>{t.key==="Enter"&&u&&(t.preventDefault(),p())};return e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-sas-gray-700",children:s}),e.jsxs("div",{className:"flex flex-wrap gap-2 min-h-[2.5rem] p-3 border border-sas-gray-300 rounded-lg bg-white",children:[l.map(t=>e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${t.color}`,children:[t.label,e.jsx("button",{type:"button",onClick:()=>L(t.id),className:"ml-2 -mr-1 hover:text-current",children:e.jsx(H,{className:"w-3 h-3"})})]},t.id)),(!x||l.length<x)&&e.jsxs("button",{type:"button",onClick:()=>c(!v),className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border border-dashed border-sas-gray-400 text-sas-gray-600 hover:border-sas-blue-400 hover:text-sas-blue-600 transition-colors",children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),"Add ",s.toLowerCase()]})]}),v&&e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-sas-gray-300 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-sas-gray-200",children:e.jsx("input",{type:"text",placeholder:D,value:o,onChange:t=>C(t.target.value),className:"w-full px-3 py-2 border border-sas-gray-300 rounded-md focus:ring-2 focus:ring-sas-blue-500 focus:border-transparent text-sm"})}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:S.length>0?e.jsx("div",{className:"py-2",children:S.map(t=>e.jsxs("button",{type:"button",onClick:()=>I(t),className:"w-full text-left px-3 py-2 hover:bg-sas-gray-50 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-sas-gray-900",children:t.label}),e.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${t.color.split(" ")[0]}`})]},t.id))}):o&&!u?e.jsxs("div",{className:"p-3 text-sm text-sas-gray-500 text-center",children:['No tags found for "',o,'"',b&&e.jsxs("button",{type:"button",onClick:()=>{f(!0),h(o)},className:"block w-full mt-2 px-3 py-2 text-sas-blue-600 hover:bg-sas-blue-50 rounded transition-colors",children:['Create "',o,'" as new tag']})]}):e.jsx("div",{className:"p-3 text-sm text-sas-gray-500 text-center",children:"No available tags"})}),u&&b&&e.jsx("div",{className:"p-3 border-t border-sas-gray-200",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Enter new tag name",value:N,onChange:t=>h(t.target.value),onKeyDown:A,className:"flex-1 px-3 py-2 border border-sas-gray-300 rounded-md focus:ring-2 focus:ring-sas-blue-500 focus:border-transparent text-sm",autoFocus:!0}),e.jsx("button",{type:"button",onClick:p,disabled:!N.trim(),className:"px-3 py-2 bg-sas-green-600 text-white rounded-md hover:bg-sas-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Add"}),e.jsx("button",{type:"button",onClick:()=>{f(!1),h("")},className:"px-3 py-2 text-sas-gray-600 hover:text-sas-gray-800 text-sm",children:"Cancel"})]})}),b&&!u&&e.jsx("div",{className:"border-t border-sas-gray-200",children:e.jsxs("button",{type:"button",onClick:()=>f(!0),className:"w-full px-3 py-2 text-left text-sm text-sas-blue-600 hover:bg-sas-blue-50 transition-colors",children:[e.jsx(U,{className:"w-4 h-4 inline mr-2"}),"Create new tag"]})})]}),e.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>{c(!1),f(!1),h(""),C("")}})]}),x&&e.jsxs("p",{className:"text-xs text-sas-gray-500",children:[l.length," of ",x," ",s.toLowerCase()," selected"]})]})},pe={getById:async s=>{const m=q(P,"users",s),l=await ie(m);if(l.exists()){const r=l.data();return{id:l.id,...r,lastLogin:r.lastLogin?.toDate(),createdAt:r.createdAt?.toDate(),updatedAt:r.updatedAt?.toDate()}}throw new Error("User not found")},update:async(s,m)=>{const l=q(P,"users",s);await ne(l,{...m,updatedAt:new Date})},list:async s=>{const m=ae(le(P,"users"),B("organizationId","==",s),B("isActive","==",!0),te("lastName"));return(await re(m)).docs.map(r=>({id:r.id,...r.data(),lastLogin:r.data().lastLogin?.toDate(),createdAt:r.data().createdAt?.toDate(),updatedAt:r.data().updatedAt?.toDate()}))}},E={users:pe,divisions:{list:async()=>[],getById:async s=>({id:s,name:"Division"})},departments:{list:async()=>[],getById:async s=>({id:s,name:"Department"})},schools:{getById:async s=>({id:s,name:"School"})}},Ce=({user:s,onUpdate:m})=>{const[l,r]=n.useState(!1),[D,x]=n.useState(!1),[b,v]=n.useState(null),[c,o]=n.useState({firstName:"",lastName:"",email:"",phoneNumber:"",title:"",pronouns:"",languages:[],subjects:[],grades:[],divisionIds:[],departmentIds:[],bio:"",preferences:{}}),[C,u]=n.useState([]),[f,N]=n.useState([]),[h,S]=n.useState([]),[I,L]=n.useState([]),[p,A]=n.useState([]),[t,j]=n.useState([]),R=["bg-blue-100 text-blue-800 border-blue-200","bg-green-100 text-green-800 border-green-200","bg-purple-100 text-purple-800 border-purple-200","bg-indigo-100 text-indigo-800 border-indigo-200"],$=["bg-orange-100 text-orange-800 border-orange-200","bg-pink-100 text-pink-800 border-pink-200","bg-teal-100 text-teal-800 border-teal-200","bg-yellow-100 text-yellow-800 border-yellow-200"];n.useEffect(()=>{s&&(o({firstName:s.firstName||"",lastName:s.lastName||"",email:s.email||"",phoneNumber:s.phoneNumber||"",title:s.title||"",pronouns:s.pronouns||"",languages:s.languages||[],subjects:s.subjects||[],grades:s.grades||[],divisionIds:s.divisionIds||[],departmentIds:s.departmentIds||[],bio:s.bio||"",preferences:s.preferences||{}}),J())},[s]);const J=async()=>{try{const[a,i]=await Promise.all([E.divisions.list(),E.departments.list()]);u(a),N(i);const d=a.map((g,w)=>({id:g.id,label:g.name,color:R[w%R.length]})),k=i.map((g,w)=>({id:g.id,label:g.name,color:$[w%$.length]}));if(S(d),L(k),s){const g=d.filter(T=>s.divisionIds?.includes(T.id)),w=k.filter(T=>s.departmentIds?.includes(T.id));A(g),j(w)}}catch(a){console.error("Failed to load divisions and departments:",a)}},X=()=>s?`${s.firstName?.charAt(0)||""}${s.lastName?.charAt(0)||""}`.toUpperCase():"U",O=a=>a?.split("_").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" ")||"",y=(a,i)=>{o(d=>({...d,[a]:i}))},Q=a=>{A(a),o(i=>({...i,divisionIds:a.map(d=>d.id)}))},W=a=>{j(a),o(i=>({...i,departmentIds:a.map(d=>d.id)}))},Y=a=>{const i=a.target.files?.[0];if(i){const d=new FileReader;d.onload=k=>{v(k.target?.result)},d.readAsDataURL(i)}},Z=async()=>{try{x(!0);const a=await E.users.update(s.id,c);m?.(a),r(!1)}catch(a){console.error("Failed to update profile:",a)}finally{x(!1)}},ee=()=>{r(!1),v(null),o({firstName:s.firstName||"",lastName:s.lastName||"",email:s.email||"",phoneNumber:s.phoneNumber||"",title:s.title||"",pronouns:s.pronouns||"",languages:s.languages||[],subjects:s.subjects||[],grades:s.grades||[],divisionIds:s.divisionIds||[],departmentIds:s.departmentIds||[],bio:s.bio||"",preferences:s.preferences||{}})};return s?e.jsx("div",{className:"min-h-screen bg-sas-background",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden mb-8",children:[e.jsx("div",{className:"h-32 bg-gradient-to-r from-sas-blue-500 to-sas-purple-600"}),e.jsxs("div",{className:"relative px-6 pb-6",children:[e.jsx("div",{className:"absolute -top-16 left-6",children:e.jsxs("div",{className:"relative",children:[b||s.avatar?e.jsx("img",{src:b||s.avatar,alt:`${s.firstName} ${s.lastName}`,className:"w-32 h-32 rounded-full border-4 border-white object-cover bg-white"}):e.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-sas-blue-500 to-sas-purple-600 rounded-full border-4 border-white flex items-center justify-center",children:e.jsx("span",{className:"text-3xl font-bold text-white",children:X()})}),l&&e.jsxs("label",{className:"absolute bottom-0 right-0 w-10 h-10 bg-sas-blue-600 rounded-full flex items-center justify-center cursor-pointer hover:bg-sas-blue-700 transition-colors",children:[e.jsx(xe,{className:"w-5 h-5 text-white"}),e.jsx("input",{type:"file",accept:"image/*",onChange:Y,className:"hidden"})]})]})}),e.jsx("div",{className:"flex justify-end pt-4",children:l?e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:ee,className:"px-4 py-2 text-sas-gray-700 border border-sas-gray-300 rounded-lg hover:bg-sas-gray-50 transition-colors flex items-center space-x-2",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"Cancel"})]}),e.jsxs("button",{onClick:Z,disabled:D,className:"px-4 py-2 bg-sas-blue-600 text-white rounded-lg hover:bg-sas-blue-700 disabled:opacity-50 transition-colors flex items-center space-x-2",children:[D?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{children:"Save Changes"})]})]}):e.jsxs("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-sas-blue-600 text-white rounded-lg hover:bg-sas-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:"Edit Profile"})]})}),e.jsx("div",{className:"mt-6 ml-40",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[l?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",value:c.firstName,onChange:a=>y("firstName",a.target.value),className:"text-2xl font-bold text-sas-gray-900 bg-transparent border-b-2 border-sas-gray-300 focus:border-sas-blue-500 focus:outline-none",placeholder:"First Name"}),e.jsx("input",{type:"text",value:c.lastName,onChange:a=>y("lastName",a.target.value),className:"text-2xl font-bold text-sas-gray-900 bg-transparent border-b-2 border-sas-gray-300 focus:border-sas-blue-500 focus:outline-none",placeholder:"Last Name"})]}):e.jsxs("h1",{className:"text-2xl font-bold text-sas-gray-900",children:[s.firstName," ",s.lastName,s.pronouns&&e.jsxs("span",{className:"text-base font-normal text-sas-gray-600 ml-2",children:["(",s.pronouns,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(F,{className:"w-4 h-4 text-sas-gray-500"}),e.jsx("span",{className:"text-sas-gray-600",children:O(s.primaryRole)})]}),s.title&&e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(z,{className:"w-4 h-4 text-sas-gray-500"}),e.jsx("span",{className:"text-sas-gray-600",children:s.title})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(M,{className:"w-4 h-4 text-sas-gray-500"}),e.jsx("span",{className:"text-sas-gray-600",children:s.email})]}),s.phoneNumber&&e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(_,{className:"w-4 h-4 text-sas-gray-500"}),e.jsx("span",{className:"text-sas-gray-600",children:s.phoneNumber})]})]}),e.jsxs("div",{children:[s.schoolName&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"w-4 h-4 text-sas-gray-500"}),e.jsx("span",{className:"text-sas-gray-600",children:s.schoolName})]}),p.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ce,{className:"w-4 h-4 text-sas-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-sas-gray-700",children:"Divisions"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:p.map(a=>e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${a.color}`,children:a.label},a.id))})]}),t.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(me,{className:"w-4 h-4 text-sas-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-sas-gray-700",children:"Departments"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.map(a=>e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${a.color}`,children:a.label},a.id))})]})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-sas-gray-900 mb-6",children:"Profile Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-sas-gray-900 mb-4",children:"Contact Information"}),l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-sas-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:c.email,onChange:a=>y("email",a.target.value),className:"w-full px-3 py-2 border border-sas-gray-300 rounded-md focus:ring-2 focus:ring-sas-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-sas-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:c.phoneNumber,onChange:a=>y("phoneNumber",a.target.value),className:"w-full px-3 py-2 border border-sas-gray-300 rounded-md focus:ring-2 focus:ring-sas-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-sas-gray-700 mb-1",children:"Job Title"}),e.jsx("input",{type:"text",value:c.title,onChange:a=>y("title",a.target.value),className:"w-full px-3 py-2 border border-sas-gray-300 rounded-md focus:ring-2 focus:ring-sas-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-sas-gray-700 mb-1",children:"Pronouns"}),e.jsx("input",{type:"text",value:c.pronouns,onChange:a=>y("pronouns",a.target.value),className:"w-full px-3 py-2 border border-sas-gray-300 rounded-md focus:ring-2 focus:ring-sas-blue-500 focus:border-transparent",placeholder:"e.g., she/her, he/him, they/them"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(M,{className:"w-5 h-5 text-sas-gray-400"}),e.jsx("span",{className:"text-sas-gray-700",children:s.email})]}),s.phoneNumber&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_,{className:"w-5 h-5 text-sas-gray-400"}),e.jsx("span",{className:"text-sas-gray-700",children:s.phoneNumber})]}),s.title&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"w-5 h-5 text-sas-gray-400"}),e.jsx("span",{className:"text-sas-gray-700",children:s.title})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-sas-gray-900 mb-4",children:"Professional Information"}),l?e.jsxs("div",{className:"space-y-4",children:[e.jsx(K,{label:"Divisions",availableTags:h,selectedTags:p,onTagsChange:Q,placeholder:"Search divisions...",allowCustomTags:!1}),e.jsx(K,{label:"Departments",availableTags:I,selectedTags:t,onTagsChange:W,placeholder:"Search departments...",allowCustomTags:!1})]}):e.jsxs("div",{className:"space-y-4",children:[p.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-sas-gray-700 mb-2",children:"Divisions"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(a=>e.jsx("span",{className:`px-3 py-1 text-sm rounded-full ${a.color}`,children:a.label},a.id))})]}),t.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-sas-gray-700 mb-2",children:"Departments"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(a=>e.jsx("span",{className:`px-3 py-1 text-sm rounded-full ${a.color}`,children:a.label},a.id))})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{className:"w-5 h-5 text-sas-gray-400"}),e.jsx("span",{className:"text-sas-gray-700",children:O(s.primaryRole)})]})]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-sas-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-sas-gray-900 mb-4",children:"Account Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sas-gray-500",children:"Employee ID:"}),e.jsx("div",{className:"font-medium text-sas-gray-900",children:s.employeeId||"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sas-gray-500",children:"Last Login:"}),e.jsx("div",{className:"font-medium text-sas-gray-900",children:s.lastLogin?new Date(s.lastLogin).toLocaleDateString():"Never"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sas-gray-500",children:"Account Status:"}),e.jsx("div",{className:"font-medium",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isActive?"Active":"Inactive"})})]})]})]})]})]})}):null};export{Ce as default};
