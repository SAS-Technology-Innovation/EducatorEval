import{h as b,c as u,d,q as m,w as g,g as h,s as I,a as E}from"./firebase.C_cAEJpe.js";async function v(){const e=document.getElementById("email").value,s=document.getElementById("primaryRole").value,r=document.getElementById("firstName").value,n=document.getElementById("lastName").value,i=document.getElementById("jobTitle").value,c=document.getElementById("employeeId").value,a=[];document.getElementById("perm-all").checked&&a.push("*"),document.getElementById("perm-users").checked&&a.push("manage_users"),document.getElementById("perm-schools").checked&&a.push("manage_schools"),document.getElementById("perm-observations").checked&&a.push("view_all_observations"),document.getElementById("perm-reports").checked&&a.push("system_reports"),document.getElementById("perm-admin").checked&&a.push("admin_panel");try{let o=null;if(!b.currentUser){t("error","You must be logged in as an admin to manage users");return}const p=u(d,"users"),y=m(p,g("email","==",e)),l=await h(y);if(!l.empty)o=l.docs[0].id,t("info",`User already exists with Firebase UID: ${o}. Updating profile...`);else{t("error",`No Firebase Auth user found for ${e}. Please ensure the user has been created in Firebase Authentication first, then have them log in once before setting up their profile.`);return}const f={id:o,email:e,firstName:r,lastName:n,displayName:`${r} ${n}`,employeeId:c,schoolId:"sas-main",divisionId:"administration",departmentId:"leadership",primaryRole:s,secondaryRoles:[],permissions:a,jobTitle:i,certifications:["Educational Leadership"],experience:"Senior Educational Leader",subjects:[],grades:[],specializations:["Educational Administration","Strategic Planning"],planningPeriods:[],languages:["English"],isActive:!0,accountStatus:"active",lastLogin:new Date,createdAt:new Date,updatedAt:new Date,metadata:{createdBy:"admin_setup",source:"manual_setup"}};await I(E(d,"users",o),f),t("success",`âœ… User profile created/updated successfully for ${e} with Firebase UID: ${o}`)}catch(o){t("error",`Error: ${o.message}`)}}async function B(){const e=document.getElementById("email").value;try{const s=u(d,"users"),r=m(s,g("email","==",e)),n=await h(r);if(n.empty)t("warning",`No profile found for ${e}`);else{const i=n.docs[0],c=i.data();t("info",`Found user with Firebase UID: ${i.id}

${JSON.stringify(c,null,2)}`)}}catch(s){t("error",`Error: ${s.message}`)}}async function U(){try{t("info",`Note: To create a user profile, the user must first:
1. Be created in Firebase Authentication (via Firebase Console)
2. Log in at least once to establish their Firebase UID
3. Then use this tool to set their role and permissions`)}catch(e){t("error",`Error: ${e.message}`)}}function t(e,s){const r=document.getElementById("result"),n=document.getElementById("resultText");r.className=`mt-8 p-4 rounded-lg ${e==="success"?"bg-green-100 border border-green-200":e==="error"?"bg-red-100 border border-red-200":e==="warning"?"bg-yellow-100 border border-yellow-200":"bg-blue-100 border border-blue-200"}`,n.textContent=s,r.classList.remove("hidden")}document.getElementById("createUser").addEventListener("click",v);document.getElementById("checkUser").addEventListener("click",B);document.getElementById("getInstructions").addEventListener("click",U);
